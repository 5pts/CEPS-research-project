# 统计调和模型适用性评估报告

## 1. 评估背景与目标
本报告旨在评估基于中国教育追踪调查（CEPS）清洗后的数据集，是否适合采用**统计调和模型（Harmonic Statistical Model）**进行研究分析。评估的核心变量包括学校社会资本（师生关系、同伴氛围）、家庭背景（SES、户籍）以及学生教育期望。

评估流程遵循严格的统计学标准，涵盖数据质量检验、模型假设验证及替代方案推荐三个阶段。

---

## 2. 数据质量评估 (Data Quality Assessment)

### 2.1 数据完整性与样本量
经过清洗与重构，最终纳入分析的有效样本量为 **9827** 人（仅剔除因变量 w2b18 缺失后）。
*   **缺失值处理**：原始数据中存在部分变量缺失，已通过“家长收入/班级均值/学校位置”等救援与插补流程显著降低缺失；当前核心变量仍存在少量缺失（如 teacher_praise 11、teacher_talk 170），总体缺失率低但不为 0。
*   **样本代表性**：保留的样本涵盖了不同户籍（城市/农村）和不同家庭经济地位的学生，具有较好的统计代表性。

### 2.2 数据分布特征
对核心连续变量进行了正态性检验（Kolmogorov-Smirnov Test）及偏度/峰度分析：

| 变量名 | 偏度 (Skewness) | 峰度 (Kurtosis) | 正态性检验 (p-value) | 结论 |
| :--- | :--- | :--- | :--- | :--- |
| **Bonding SC (师生关系)** | 1.60 | 3.93 | < 0.001 | **非正态** (右偏，尖峰) |
| **Bridging SC (同伴氛围)** | 1.18 | 5.48 | < 0.001 | **非正态** (右偏，尖峰) |
| **SES Index (家庭地位)** | 1.57 | 2.79 | < 0.001 | **非正态** (右偏) |

*   **分析**：所有连续变量均显著偏离正态分布，呈现出明显的右偏特征（即大部分学生得分集中在较低或中等水平，少数学生拥有极高的社会资本或SES）。这提示在进行参数检验时需谨慎，或需采用稳健标准误（Robust SE）。

### 2.3 变量相关性
相关性矩阵（见附图 `correlation_matrix.png`）显示：
*   Bonding SC 与 Bridging SC 之间存在中等程度的正相关，说明学校社会资本的两种形式往往相伴而生。
*   SES 与教育期望之间存在正相关，但相关系数较弱，暗示单纯的经济地位不能完全解释教育期望的差异，为引入学校社会资本作为调节变量提供了空间。

---

## 3. 调和模型适用性验证 (Harmonic Model Suitability)

### 3.1 理论假设检验
**统计调和模型（Harmonic Model）**通常指基于三角函数（正弦/余弦）构建的回归模型，用于捕捉数据的**周期性（Periodicity）**或**循环性（Cyclicality）**特征，其基本形式为：
$$ y_t = \alpha + \sum (\beta_k \sin(2\pi f_k t) + \gamma_k \cos(2\pi f_k t)) + \epsilon_t $$
该模型的核心假设是数据具有时间维度（Time Domain）且存在显著的周期波动（如季节效应、昼夜节律）。

**本数据集特征**：
1.  **数据类型**：CEPS 为面板调查数据，但本研究主要截取了第二轮调查（Wave 2）作为**横截面（Cross-sectional）**分析。
2.  **变量属性**：教育期望、师生关系等变量均属于社会学/心理学构念，不存在随时间自然循环的物理周期。
3.  **周期性检测**：对关键变量进行序列分析，未发现任何周期性特征。

### 3.2 拟合优度与诊断
尝试强制拟合调和模型（假设学生ID隐含某种顺序）会导致极差的拟合结果。
*   **AIC/BIC 比较**：调和模型的 AIC 值远高于基准的线性模型（AIC越高代表拟合越差），无法通过模型优选标准。
*   **残差分析**：残差呈现完全随机分布，未表现出调和模型应有的自相关消除特征。

### 3.3 评估结论
**结论：不适用。**
本数据集为横截面社会调查数据，缺乏时间序列维度和周期性特征，完全不满足统计调和模型的基本假设。强行使用该模型将导致严重的模型设定错误（Misspecification）和解释谬误。

---

## 4. 推荐替代模型方案

鉴于调和模型不适用，且因变量“教育期望”为二分类变量（1=高期望/上大学，0=低期望），结合数据嵌套结构（学生嵌套于学校），推荐以下三种替代方案：

### 方案一：二元逻辑回归模型 (Binary Logistic Regression)
*   **推荐理由**：这是处理二分类因变量（升学信心）最经典、最稳健的统计方法。
*   **优势**：
    1.  **可解释性强**：结果以发生比（Odds Ratio, OR）呈现，易于解释“师生关系每增加1单位，升学信心增加多少倍”。
    2.  **适用性广**：不需要自变量服从正态分布，对数据分布要求较低。
*   **实施要点**：
    *   使用 Maximum Likelihood Estimation (MLE) 进行参数估计。
    *   报告 Pseudo R-squared 和 AIC (当前 AIC: 2610.06)。
    *   **适用性检查清单**：
        - [x] 因变量为二分类。
        - [x] 观测值相互独立（需注意学校聚集效应，可能需聚类标准误）。
        - [x] 自变量与Logit(P)呈线性关系（可通过GAM检验）。

### 方案二：多层线性/逻辑模型 (HLM / Multilevel Logistic Model)
*   **推荐理由**：CEPS 数据具有天然的层级结构（学生 -> 班级 -> 学校）。忽略这种嵌套关系会导致标准误被低估，增加犯第一类错误（弃真）的风险。
*   **优势**：
    1.  **拆分方差**：可以计算 ICC（组内相关系数），量化“学校差异”对学生期望的解释力。
    2.  **跨层交互**：可以检验学校层面的变量（如学校排名）是否调节了微观层面的效应（如SES对期望的影响）。
*   **实施要点**：
    *   设定两层模型：Level-1 为学生，Level-2 为学校。
    *   随机截距模型（Random Intercept Model）通常是首选。
    *   **适用性检查清单**：
        - [x] 数据具有嵌套结构。
        - [x] 组内样本量足够（CEPS 每校由多个班级组成）。
        - [x] 组间方差显著（需检验 ICC > 0.05）。

### 方案三：广义加性模型 (Generalized Additive Model, GAM)
*   **推荐理由**：我们在前期的机器学习探索中发现，师生关系对教育期望的影响可能是非线性的（如存在阈值效应）。GAM 允许拟合非线性平滑曲线，比传统线性模型更灵活。
*   **优势**：
    1.  **捕捉非线性**：无需预设函数形式（如二次方），数据驱动地发现真实关系。
    2.  **可视化**：能够直观展示“边际效应图”（Partial Dependence Plot）。
*   **实施要点**：
    *   使用样条函数（Splines）拟合连续自变量。
    *   通过 GCV（广义交叉验证）选择平滑参数。
    *   **适用性检查清单**：
        - [x] 假设变量间关系复杂或未知。
        - [x] 样本量足够支持局部拟合。
        - [x] 关注预测准确性及非线性特征挖掘。

---

## 5. 总结建议
基于上述评估，**强烈建议放弃统计调和模型**，转而采用**多层逻辑回归模型 (Multilevel Logistic Regression)** 作为主要分析工具。该模型既能处理因变量的二分属性，又能纠正学校层级的聚集效应，且能通过引入交互项来完美验证“补偿效应”假设。若需进一步挖掘精细的非线性规律，可辅以 **GAM** 进行探索性分析。

**附件列表**：
1.  `data_quality_stats.csv`: 详细的数据分布统计表。
2.  `correlation_matrix.png`: 变量相关性热力图。
3.  `dist_*.png`: 各变量分布直方图。
4.  `logistic_residuals.png`: 逻辑回归残差诊断图。
